syntax = "proto3";

package witwiz;

option go_package="witwiz/proto";

service WitWiz {
    rpc JoinGame(stream PlayerInput) returns (stream GameStateUpdate) {}
}

message PlayerInput {
    int32 player_id = 1;
    Action action = 2;
    enum Action {
        NONE = 0;
        MOVE_RIGHT_START = 1;
        MOVE_RIGHT_STOP = 2;
        MOVE_LEFT_START = 3;
        MOVE_LEFT_STOP  = 4;
        MOVE_UP_START = 5;
        MOVE_UP_STOP = 6;
        MOVE_DOWN_START = 7;
        MOVE_DOWN_STOP = 8;
        SHOOT = 9;
        REPORT_VIEWPORT = 10;
    }
    ViewPort view_port = 3;
}

message GameStateUpdate {
    repeated PlayerState players = 1;
    repeated ProjectileState projectiles = 2;
    int32 your_player_id = 3;
    ViewPort world_view_port = 4;
}

message PlayerState {
    int32 player_id = 1;
    Vector2 position = 2;
    Vector2 velocity = 3;
    Vector2 acceleration = 4;
    BoundingBox boundingBox = 5;
    float maxSpeed = 6;
    Vector2 targetVelocity = 7;
}

message ProjectileState {
    int32 projectile_id = 1;
    int32 owner_id = 2;
    Vector2 position = 3;
    Vector2 velocity = 4;
    BoundingBox boundingBox = 5;
    float maxSpeed = 6;
}

message Vector2 {
    float x = 1;
    float y = 2;
}

message BoundingBox {
    float width = 1;
    float height = 2;
}

message ViewPort {
    float width = 1;
    float height = 2;
}